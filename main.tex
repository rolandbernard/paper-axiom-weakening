%% The first command in your LaTeX source must be the \documentclass command.
%%
%% Options:
%% twocolumn : Two column layout.
%% hf: enable header and footer.
\documentclass[
% twocolumn,
% hf,
]{ceurart}

%%
%% One can fix some overfulls
\sloppy

%%
%% Minted listings support 
%% Need pygment <http://pygments.org/> <http://pypi.python.org/pypi/Pygments>
\usepackage{listings}
%% auto break lines
\lstset{breaklines=true}

%%
%% DL Logo for inline use
\usepackage{graphbox}
\DeclareRobustCommand{\DLLogo}{%
  \begingroup\normalfont
  \kern-1.75pt\includegraphics[align=c,height=1.25\baselineskip]{dl}\kern-1.5pt%
  \endgroup
}

%%
%% AMS Theorems
\usepackage{amsthm}
\newtheorem{theorem}{Theorem}
\newtheorem{definition}{Definition}
\newtheorem{example}{Example}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% OUR SETTINGS
\usepackage{cleveref}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{algorithm}
\usepackage{algpseudocode}
% \usepackage{theorem}
\usepackage{xspace}
\usepackage{dl}
\usepackage{url}
%\usepackage[numbers]{natbib}
\clubpenalty = 10000
\widowpenalty = 10000
\displaywidowpenalty = 10000
\input{macros}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%
%% end of the preamble, start of the body of the document source.
\begin{document}

%%
%% Rights management information.
%% CC-BY is default license.
\copyrightyear{2023}
\copyrightclause{Copyright for this paper by its authors.
  Use permitted under Creative Commons License Attribution 4.0
  International (CC BY 4.0).}

%%
%% This command is for the conference information
\conference{\DLLogo{} DL 2023: 36th International Workshop on Description Logics,
  September 2--4, 2023, Rhodes, Greece}

%%
%% The "title" command
\title{Implementing Axiom Weakening for SROIQ}

%%
%% The "author" command and its associated commands are used to define
%% the authors and their affiliations.

\author[1]{Roland Bernard}[
email=roland.bernard@student.unibz.it,
]
\author[1]{Oliver Kutz}[
email=oliver.kutz@unibz.it,
]
\author[1]{Nicolas Troquard}[
email=nicolas.troquard@unibz.it,
]
\address[1]{
Free University of Bozen-Bolzano, Italy
}

%%
%% The abstract is a short summary of the work to be presented in the
%% article.
\begin{abstract}
Axiom weakening is a technique that allows for a fine-grained repair of inconsistent ontologies. Its main advantage is that it repairs ontologies by making axioms less restrictive rather than by deleting them, employing refinement operators. In this paper, we build on previously introduced axiom weakening for \ALC, and show how it can be extended to deal with \SROIQ, the expressive and decidable description logic underlying OWL 2 DL. We here focus on describing a prototype implementation computing axiom weakening for \SROIQ and discuss a number of performance and evaluation aspects.
%the definitions of the refinement operators to deal with \SROIQ constructs, in particular with %such as reflexive and irreflexive roles, disjoint roles, role hierarchies,  cardinality constraints and nominals, and illustrate its application. Finally, we discuss the problem of termination of an iterated weakening procedure.
\end{abstract}

%%
%% Keywords. The author(s) should pick words that accurately describe
%% the work being presented. Separate the keywords with commas.
\begin{keywords}
  Description Logic \sep
  Knowledge refinement \sep
  Prot\'eg\'e
\end{keywords}

%%
%% This command processes the author and affiliation and title
%% information and builds the first part of the formatted document.
\maketitle

\section{Introduction: Weakening for debugging}

% motivate repair using axiom weakening

\begin{example}
% give an example ontology where classical repairs are insufficient
% give an example where it is advantageous to weaken the role hierarchy
\end{example}

% explain other gentle repair approaches
% briefly describe refinement operators
% briefly describe what we have done

\section{Axiom Weakening for \ALC}

% describe the ALC syntax and semantics
Formally, an ontology is a set of statements expressed in a suitable logical language and with the purpose of describing a specific domain of interest. 

% define sub concepts

% define upward and downward covers

\begin{example}
% give an example of some cover applications
\end{example}

% define the abstract and concrete refinement operators

\begin{example}
% give an example of the concrete refinement operators
\end{example}

% define the weakening operator

\begin{example}
% give an example of the weakening operator
\end{example}

\section{Extending Weakening to \SROIQ}

% describe the SROIQ syntax
% describe roles and concepts
We now give a brief description of the DL \SROIQ; for full details see \cite{baader_horrocks_lutz_sattler_2017,HorrocksKutzSattlerKR2006}. The syntax of \SROIQ is based on a vocabulary of three disjoint sets $N_I$, $N_R$, $N_C$ of \emph{individual names}, \emph{role names}, and \emph{concept names}. The set of \SROIQ \emph{concepts} and \emph{roles} is generated by the following grammar.

\begin{eqnarray*}
  R, S & ::= & U \mid E \mid r \mid r^{-} \enspace,\\
  C & ::= & \bot \mid \top \mid A \mid \neg C \mid C \sqcap C \mid C \sqcup C \mid \forall R.C \mid \exists R.C \mid \\ 
  & & \more n S.C \mid \less n S.C \mid \exists S.\self \mid \nominal i \enspace,
\end{eqnarray*}

where $r \in N_R$ is a role name, $A \in N_C$ is a concept name, $i \in N_I$ is an individual name and $n \in \mathbb{N}_0$ is a non-negative integer. $U$ and $E$ are respectively the universal role and empty role. $S$ is a \emph{simple role} (see below) in the RBox $\Rmc$.

% describe the TBox, ABox and RBox statements
A \emph{TBox} $\Tmc$ is a finite set of concept inclusions (GCIs) of the form $C \sqsubseteq D$ where $C$ and $D$ are concepts. The TBox is used to stores terminological knowledge concerning the relationship between concepts. A \emph{ABox} $\Amc$ is a finite set of statements of the form $R(a)$, $\lnot R (a)$, $a = b$, and $a \not= b$ where $R$ is a role and $a$ and $b$ are individual names. The ABox expresses knowledge regarding individuals in the domain. A \emph{RBox} $\Rmc$ is a finite set of role inclusions (RIAs) of the form $R_1 \circ \cdots \circ R_n \sqsubseteq R$, and disjoint role axioms $\disjoint(S_1, S_2)$ where $R$, $R_1$, $\dots$, $R_n$, $S_1$, and $S_2$ are roles. $S_1$ and $S_2$ are simple (see next) in the RBox $\Rmc$. The special case of $n = 1$ is a simple role inclusion, while we call the cases where $n > 1$ complex role inclusions. The RBox represents knowledge about the relationship between roles.

% describe simple and complex roles since it is relevant
The set of \emph{non-simple} roles in $\Rmc$ is the smallest set such that: $U$ and $E$ are non-simple; any role $R$ that appears on the right-hand side of a complex RIA $R_1 \circ \cdots \circ R_n \sqsubseteq R$ where $n > 1$ is non-simple; any role $R$ that appears on the right-hand side of a simple RIA $S \sqsubseteq R$ where $S$ is non-simple, is also non-simple; and a role $r$ is non-simple if and only if $r^-$ is non-simple.
All other roles are \emph{simple}.

% describe regularity since it is relevant
For convenience, let us define the function $\inv(R)$ such that $\inv(r) = r^-$ and $\inv(r^-) = r$ for all role names $r \in N_R$. A RBox $\Rmc$ is \emph{regular} if there exists a pre-order $\preceq$, i.e., a transitive and reflexive relation, over the set of roles such that $R \preceq S \iff \inv(R) \preceq \inv(S)$, $R \preceq S \iff \inv(R) \preceq S$, and all RIAs in $\Rmc$ are of the forms:
$\inv(R) \sqsubseteq R$,
$R \circ R \sqsubseteq R$,
$S \sqsubseteq R$, $R \circ S_1 \circ \cdots \circ S_n \sqsubseteq R$,
$S_1 \circ \cdots \circ S_n \circ R \sqsubseteq R$, or
$S_1 \circ \cdots \circ S_n \sqsubseteq R$
where $r \in N_R$ is a role name and $R$, $S$, $S_1, \cdots, S_n$ are roles such that $S \preceq R$, $S_i \preceq R$, and $R \not\preceq S_i$ for $i = 1, \dots, n$.

A \SROIQ ontology $\Omc = \Tmc \cup \Amc \cup \Rmc$ consists of a TBox $\Tmc$, an ABox $\Amc$, and a RBox $\Rmc$, where $\Rmc$ is regular.

% describe the semantics
% whats a interpretation, when is it a model
The semantics of \SROIQ are defined using \emph{interpretations} $I = \langle \Delta^I, \cdot^I \rangle$ where $\Delta^I$ is a non-empty \emph{domain} and $\cdot^I$ is a function associating to each individual name $a$ an element of the domain $a^I \in \Delta^I$, to each concept $C$ a subset of the domain $C^I \subseteq \Delta^I$, and to each role $R$ a binary relation on the domain $R^I \subseteq \Delta^I \bigtimes \Delta^I$; see \cite{baader_horrocks_lutz_sattler_2017,HorrocksKutzSattlerKR2006} for further details. An interpretation $I$ is a \emph{model} for $\Omc$ if it satisfies all the axioms in $\Omc$.

% describe subsumptions of concepts and roles
Given two concepts $C$ and $D$ we say that $C$ is \emph{subsumed} by $D$ (or $D$ \emph{subsumes} $C$) with respect to the ontology $\Omc$, written $C \sqsubseteq_\Omc D$, if $C^I \subseteq D^I$ in every model $I$ of $\Omc$. Further $C$ is \emph{strictly subsumed by} $D$, written $C \sqsubset_\Omc D$, if $C \sqsubseteq_\Omc D$ but not $D \sqsubseteq_\Omc C$. Analogously, given two roles $R$ and $S$, $R$ is subsumed by $S$ with respect to $\Omc$ ($R \sqsubseteq_\Omc S$) if $R^I \sqsubseteq S^I$ in all models $I$ of $\Omc$. Again, $R \sqsubset_\Omc S$ holds if $R \sqsubseteq_\Omc S$ but not $D \sqsubseteq_\Omc C$

% explain the complications of weakening SROIQ
The main difficulties that arise when weakening axioms in \SROIQ ontologies, and especially when weakening RIAs, are related to ensuring that the constraints on the use of non-simple roles and the regularity of the role hierarchy are maintained. Not every weaker axiom can be inserted into a valid \SROIQ ontology without causing a violation of these restrictions.

% example of the complications of weakening SROIQ
\begin{example}
  Take the ontology $\Omc = \{ r \circ s \circ r \sqsubseteq t, r \sqsubseteq s, \top \sqsubseteq \forall t.\bot, \exists s.\self \sqsubseteq \top \}$. Since $t$ is empty in every model of this ontology, the axiom $r \sqsubseteq s$ could be weakened to $t \sqsubseteq s$ if we ignore the additional constraints. This would result in an ontology where $s$ is non-simple, which is not allowed since $s$ is used as part of a self constraint.
  Additionally, using this weakening would also cause a non-regular RBox, because for any pre-order $\preceq$, $t \not\preceq s$ must hold for the complex RIA and $t \preceq s$ must hold for the new axiom. Yet, this is a contradiction.
\end{example}

% lay out the constraints that we want to maintain
To prevent these kinds of issues, we restrict how concepts are refined, and RIA can be weakened. To achieve this, we must ensure that only simple roles are used when weakening disjoint role axioms or refining cardinality and self constraints. Further, it must be guaranteed that all roles that are currently used in such context remain simple when adding the weakened axioms to the ontology. Finally, the addition of a weakened axiom must maintain the regularity of the role hierarchy. We discuss now the restrictions we applied in order to satisfy these requirements.

% explain how each of them can be ensured
Firstly, the covers and refinement operators for roles operate only on roles that are simple. A similar restriction has already been applied in the refinement operator suggested in \cite{confalonieri2020towards}. Restricting the refinement to simple roles guarantees that the new axioms created by weakening will not contain non-simple roles in axioms or concepts where they are not allowed. An important detail to not here is that the roles over which the covers operate must be simple in all ontologies that the weaker axioms are used in. It is therefore not generally sufficient to use the roles that are simple in the reference ontology, since the reference ontology may not contain all RBox axioms, and therefore contain simple roles that are not simple in the full ontology. For this reason we give to the upward and downward cover as an argument not only the reference ontology $\Omcref$, but also the full ontology $\Omcfull$. In the context of repairing inconsistent ontologies, $\Omcfull$ can be chosen to be the inconsistent ontology that we want to repair.

Then, to ensure further that by adding weakened axioms we do not cause a constraint violation in existing axioms and concepts, we choose the allowed weakening for RIAs such that all roles that are simple in $\Omcfull$, are also simple after adding to it a weakening of one of its axioms. We observe that for complex RIAs $S_1 \circ \cdots \circ S_n \sqsubseteq R$ we should not refine the role $R$. Since all roles returned by our refinement operator are simple in $\Omcfull$, such a replacement would make a role with was simple in $\Omcfull$ non-simple. A similar argument can be made for refining $R$ in a simple RIA $S \sqsubseteq R$ where the role $S$ is non-simple in $\Omcfull$. So the only way to refine the right-hand side during the weakening of a RIA is when it is a simple RIA and additionally the left-hand side of the axiom is simple in $\Omcfull$.

When it comes to refining the left-hand side of RIAs, we do not need any special restrictions. The main significant observation is that all roles that are returned by the refinement will be simple. This means that in a simple RIA $R \sqsubseteq S$, even if $S$ is simple, replacing $R$ with another simple role will not cause $S$ to become non-simple. For a complex RIA $S_1 \circ \cdots \circ S_n \sqsubseteq R$ on the other hand, the role $R$ must already have been non-simple in $\Omcfull$, and replacing any $S_i$ with a refinement has no effect on which roles are simple.

A more interesting question is whether such a weakening may still cause a non-regular role hierarchy. The important insight is that simple roles are always allowed on the left-hand side of a RIA. While this is more directly evident in some alternative definitions of regularity (e.g., \cite{rudolph2011foundations}) it is not so apparent form the one presented in this paper. Intuitively, the constraint given above for regularity disallows dependency cycles that contain complex RIAs. Simple roles can not be part of such a cycle, since the cycle must contain at least one complex RIA to be a violation of the constraint, and all roles that depend in this sense on a complex RIA must be non-simple. A more formal justification for this fact is given in the \hyperref[proof:global-constraints]{proof} for \cref{lemma:global-constraints}.
Since all refinements of the left-hand side of RIAs are performed using simple roles, these can not lead to a non-regular RBox. Further, refinements of the right-hand side of RIAs are only performed on simple RIAs $S \sqsubseteq R$ where $S$ is a simple role. Since $S$ is simple in this case, all refinements of $R$ are allowed, potentially also if the refinement yielded a non-simple role.

\begin{definition}
  Let $\Omc$ be a \SROIQ ontology. The set of \emph{subconcepts} of $\Omc$ is given by 
  \begin{align*}
    \sub(\Omc) = \{\top, \bot\} \cup \bigcup_{C(a) \in \Omc} \sub(C) \cup \bigcup_{C \sqsubseteq D \in \Omc} \left( \sub(C) \cup \sub(D) \right)
  \end{align*}
  where $\sub(C)$ is the set of \emph{subconcepts} in $C$ given by
  \begin{align*}
    \sub(A) &= \{ A \} \quad , A \in N_C \cup \{ \top, \bot \} &
    \sub(\lnot C) &= \{ \lnot C \} \cup \sub(C) \\
    \sub(C \sqcup D) &= \{ C \sqcup D \} \cup \sub(C) \cup \sub(D) &
    \sub(\forall R.C) &= \{ \forall R.C \} \cup \sub(C) \\
    \sub(C \sqcap D) &= \{ C \sqcap D \} \cup \sub(C) \cup \sub(D) &
    \sub(\exists R.C) &= \{ \exists R.C \} \cup \sub(C) \\
    \sub(\more n R.C) &= \{ \more n R.C \} \cup \sub(C) &
    \sub(\less n R.C) &= \{ \less n R.C \} \cup \sub(C) \\
    \sub(\exists R.\self) &= \{ \exists R.\self \} &
    \sub(\nominal{i}) &= \{ \nominal{i} \}
  \end{align*}
\end{definition}

% define upward and downward covers
% define the abstract refinement operator
% define the concrete generalization and specialization operator
% define the weakening operator

\begin{example}
% give an example of the weakening operator
\end{example}

% proof that the constrains are retained
\begin{lemma} \label{lemma:global-constraints}
\end{lemma}

\begin{proof}(\emph{Sketch})
  \phantomsection\label{proof:global-constraints}
\end{proof}

\section{Implementing Axiom Weakening for \SROIQ}

% explain how the weakening is used for repair
% explain how the reference ontology is selected
% explain how bad axioms are selected

\section{Weakening makes you strong: evaluation aspects}

% explain how different repairs are compared
% explain how inconsistent ontologies were generated
% explain that the OWL 2 ontologies were normalized to only use SROIQ axioms
% show results of the evaluation

\section{Outlook}

% complex roles in up and down covers
% more permissive refinement of role inclusions
% working directly with OWL 2 axioms
% how to steer the repair process

%%
%% Define the bibliography file to be used
\bibliography{biblio}

%%
%% If your work has an appendix, this is the place to put it.
\appendix


\end{document}

%%
%% End of file
